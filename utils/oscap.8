.TH OSCAP "8" "Jun 2010" "Red Hat" "System Administration Utilities"

.SH NAME
oscap \- OpenSCAP command line tool

.SH SYNOPSIS
\fBoscap\fR [\fIgeneral-options\fR] \fBmodule\fR operation [\fIoperation-options-and-arguments\fR]

.SH DESCRIPTION
\fBoscap\fP is Security Content Automation Protocol (SCAP) toolkit based on OpenSCAP library. It provides various functions for 
different SCAP specifications(modules).

.SH GENERAL OPTIONS
.TP
\fB\-V, -\-version\fR
SCAP specification supported by the module.
.TP
\fB\-q, \-\-quiet\fR
No output for certain operations, only return code.
.TP
\fB\-h, \-\-help\fR
Help screen.

.SH MODULES
.TP
\fBoval\fR
Open Vulnerability and Assessment Language.
.TP
\fBxccdf\fR
The eXtensible Configuration Checklist Description Format.
.TP
\fBcpe\fR
Common Platform Enumeration.
.TP
\fBcvss\fR
Common Vulnerability Scoring System

.SH OVAL OPERATIONS
.TP
.B collect\fR definitions-file
.RS
Probe the system and gather system characteristics for objects in OVAL Definition file. Print output (OVAL System Characteristic) to standart output.
.RE
.PP
.B eval\fR [\fIoptions\fR] definitions-file
.RS
Probe the system and evaluate all definitions from OVAL Definition file. Print result of each definition to standard output. oscap returns 0 if all definitions pass. If there is an error during evaluation, the return code is 1. If there is at least one failed result definition, oscap-scan finishes with return code 2.
.PP
.TP
\fB\-\-id DEFINITION-ID\fR
Probe the system and evaluate ONLY specified definition from OVAL Definition file.
.TP
\fB\-\-result-file FILE\fR
Write OVAL Results into file.
.TP
\fB\-\-report-file FILE\fR
Write HTML results report into file.
.TP
\fB\-\-skip-valid\fR
Do not validate input files before evaluation.
.RE
.RE

.TP
.B analyse\fR [\fIoptions\fR] definitions-file syschar-file
.RS
In this mode, the oscap tool does not perform data collection on the local system, but relies upon the input file, which may have been generated on another system.
.TP
\fB\-\-result-file FILE\fR
Write OVAL Results into file.
.RE

.TP
.B validate-xml\fR [\fIoptions\fR] definitions-file
.RS
Validate given OVAL file against a XML schema. Every found error is printed to the standard output. Return code is 0 if validation succeeds, 1 if validation could not be performed due to some error, 2 if the OVAL document is not valid.
.TP
\fB\-\-version VER\fR
Specify version of the specification the document shall conform to.
.TP
\fB\-\-definitions\fR, \fB\-\-syschar\fR, \fB\-\-results\fR
Specify whether the validated document is an OVAL definitions file, OVAL system characteristics file, or OVAL results file. Default: definitions.
.RE
.TP
.B \fBgenerate\fR <submodule> [submodule-specific-options]
.RS
Generate another document form an OVAL file.
.TP
Available submodules:
.TP
.B \fBreport\fR  [\fIoptions\fR] oval-results-file
.RS
Generate a formatted HTML page containing visualisation of an OVAL results file. Unless the --output option is specified it will be written to the standard output.
.TP
\fB\-\-output FILE\fR
Write the report to this file instead of standard output.
.RE

.SH XCCDF OPERATIONS
.TP
.B \fBeval\fR [\fIoptions\fR] xccdf-file [\fIoval-definitions-files\fR]
.RS
Perform evaluation driven by XCCDF file and use OVAL as checking engine. Print result of each rule to standard output. oscap returns 0 if all rules pass. If there is an error during evaluation, the return code is 1. If there is at least one failed rule, oscap-scan finishes with return code 2.
.PP
You may specify all required OVAL Definition files as last parameters. If you don't do that, oscap tool will try to load all OVAL Definition files referenced from XCCDF automaticaly(search in the same path as XCCDF).
.PP
.TP
\fB\-\-profile PROFILE\fR
.RS
Select profile from XCCDF document, otherwise the first profile is used.
.RE
.TP
\fB\-\-result-file FILE\fR
.RS
Write XCCDF results into file.
.RE
.TP
\fB\-\-report-file FILE\fR
.RS
Write HTML report into file. You also have to specify --result-file for this feature to work.
.RE
.TP
\fB\-\-oval-results\fR
.RS
Generate OVAL Result file for each OVAL session used for evaluation. File with name '\fIoriginal-oval-definitions-filename\fR.result.xml' will be generated for each referenced OVAL file. This option (with conjunction with the \fB\-\-report-file\fR option) also enables inclusion of additional OVAL information in the XCCDF report.
.RE
.TP
\fB\-\-skip-valid\fR
.RS
Do not validate input files before evaluation.
.RE
.RE
.TP
.B resolve\fR -o output-file xccdf-file
.RS
Resolve an XCCDF file as described in the XCCDF specification. It will flatten inheritance hierarchy of XCCDF profiles, groups, rules, and values. Result is another XCCDF document, which will be written to \fIoutput-file\fR.
.TP
\fB\-\-force\fR
Force resolving XCCDF document even if it is already marked as resolved.
.RE
.TP
.B validate-xml\fR [\fIoptions\fR] xccdf-file
.RS
Validate given XCCDF file against a XML schema. Every found error is printed to the standard output. Return code is 0 if validation succeeds, 1 if validation could not be performed due to some error, 2 if the XCCDF document is not valid.
.TP
\fB\-\-version VER\fR
Specify version of the specification the document shall conform to.
.RE
.TP
.B \fBgenerate\fR [\fIoptions\fR] <submodule> [submodule-specific-options]
.RS
Generate another document form an XCCDF file such as security guide or result report.
.TP
\fB\-\-profile ID\fR
Apply profile with given ID to the Benchmark before further processing takes place.
.TP
\fB\-\-format FMT\fR
Specify output format. This option applies only on document generators (i.e. guide, report). Avalable formats: \fIhtml\fR (default), \fIdocbook\fR.
.TP
Available submodules:
.TP
.B \fBguide\fR  [\fIoptions\fR] xccdf-file
.RS
Generate a formatted document containing a security guide from a XCCDF Benchmark. Unless the --output option is specified it will be written to the standard output. Without profile being set only groups (not rules) will be included in the output.
.TP
\fB\-\-output FILE\fR
Write the guide to this file instead of standard output.
.TP
\fB\-\-hide-profile-info\fR
Information on chosen profile (e.g. rules selected by the profile) will be excluded from the document.
.RE
.TP
.B \fBreport\fR  [\fIoptions\fR] xccdf-file
.RS
Generate a document containing results of a XCCDF Benchmark execution. Unless the --output option is specified it will be written to the standard output. ID of the TestResult element to visualise defaults to the most recent result (according to the end-time attribute).
.TP
\fB\-\-output FILE\fR
Write the report to this file instead of standard output.
.TP
\fB\-\-result-id ID\fR
ID of the XCCDF TestResult from which the report will be generated.
.TP
\fB\-\-show \fIwhat\fR
Specify what result types shall be displayed in the result report. The default is to show everything except for rules with results notselected and notapplicable. The \fIwhat\fR part is a comma-separated list of result types to display in addition to the default. If result type is prefixed by a dash '-', it will be excluded from the results. If \fIwhat\fR is prefixed by an equality sign '=', a following list specifies exactly what rule types to include in the report. Result types are: pass, fixed, notchecked, notapplicable, notselected, informational, unknown, error, fail.
.TP
\fB\-\-oval-template \fItemplate-string\fR
To use the ability to include additional information from OVAL in xccdf result file, a template which will be used to obtain OVAL result file names has to be specified. The template can be either a filename or a string containing wildcard character (percent sign '%'). Wildcard will be replaced by the original OVAL definition file name as referenced from the XCCDF file. This way it is possible to obtain OVAL information even from XCCDF documents referencing several OVAL files. To use this option with results from an XCCDF evaluation, specify \fI%.result.xml\fR as a OVAL file name template.
.RE
.TP
.B \fBfix\fR  [\fIoptions\fR] xccdf-file
.RS
Generate a script that shall bring the system to a state of compliance with given XCCDF Benchmark.
.TP
\fB\-\-output FILE\fR
Write the report to this file instead of standard output.
.TP
\fB\-\-result-id \fIID\fR\fR
With this option the script generating engine will pick rules that failed for given test and generate fixes only for them.
.TP
\fB\-\-template \fIID|FILE\fR\fR
Template to be used to generate the script. If it contains a dot '.' it is interpreted as a location of a file with the template definition. Otherwise it identifies a template from standard set which currently includes: \fIbash\fR (default if no --template switch present). Brief explanation of the process of writing your own templates is in the XSL file \fIxsl/fix.xsl\fR in the openscap data directory. You can also take a look at the default template \fIxsl/fixtpl-bash.xml\fR.
.RE

.SH CPE OPERATIONS
.TP
.B \fBcheck\fR name
.RS
Check whether name is in correct CPE format.
.RE
.PP
.B \fBmatch\fR name dictionary.xml
.RS
Find an exact match of CPE name in the dictionary.

.SH CVSS OPERATIONS
.TP
.B base\fR \fImetrics\fR
.RS
Calculate base score from Access Vector (AV), Access Complexity (AC), Authentication(AU), Confidentiality Impact(CI),  Integrity Impact(II) and Availability Impact(AI) metric.
.RE
.PP
.B temporal\fR --base <num> [\fImetrics\fR]
.RS
Calculate temporal score from base score, Exploitability(EX), Remediation Level(RL) and Report Confidence(RC) metric.
.RE
.PP
.B environmental\fR \fImetrics\fR
.RS
Calculate environmental score from Collateral Damage Potential(CD), Target Distribution(TD), Confidentiality Requirement (CR),  Integrity Requirement(IR), Availability Requirement(AR),
Access Vector (AV), Access Complexity (AC), Authentication(AU), Confidentiality Impact(CI),  Integrity Impact(II), Availability Impact(AI), Exploitability(EX), Remediation Level(RL) and Report Confidence(RC) metric.
.RE
.PP
metrics:
.TP
\fB\-\-AV=\fR[local|adjacent-network|network] - Access Vector (required)
.TP
\fB\-\-AC=\fR[low|medium|high] - Access Complexity (required)
.TP
\fB\-\-AU=\fR[none|single|multiple] - Authentication (required)
.TP
\fB\-\-CI=\fR[none|partial|complete] - Confidentiality Impact (required)
.TP
\fB\-\-II=\fR[none|partial|complete] - Integrity Impact (required)
.TP
\fB\-\-AI=\fR[none|partial|complete] - Availability Impact (required)
.TP
\fB\-\-EX=\fR[unproven|proof-of-concept|functional|high|not-defined] - Exploitability
.TP
\fB\-\-RL=\fR[official-fix|temporary-fix|workaround|unavailable|not-defined] - Remediation Level
.TP
\fB\-\-RC=\fR[unconfirmed|uncorrporated|confirmed|not-defined] - Report Confidence
.TP
\fB\-\-CD=\fR[none|low|low-medium|medium-high|high|not-defined] - Collateral Damage Potential
.TP
\fB\-\-TD=\fR[none|low|medium|high|not-defined] - Target Distribution
.TP
\fB\-\-CR=\fR[low|medium|high|not-defined] - Confidentiality Requirement
.TP
\fB\-\-IR=\fR[low|medium|high|not-defined] - Integrity Requirement
.TP
\fB\-\-AR=\fR[low|medium|high|not-defined] - Availability Requirement


.SH CONTENT
.TP
\fB National Vulnerability Database\fR - \fIhttp://web.nvd.nist.gov/view/ncp/repository\fR
.TP
\fB Red Hat content repository\fR - \fIhttp://www.redhat.com/security/data/oval/\fR


.SH AUTHOR
Peter Vrabec <pvrabec@redhat.com>
